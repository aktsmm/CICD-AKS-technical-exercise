# kubectl ã‚¢ã‚¯ã‚»ã‚¹çµŒè·¯ã®è©³ç´°

**ä½œæˆæ—¥**: 2025 å¹´ 10 æœˆ 31 æ—¥  
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: CICD-AKS-Technical Exercise

---

## ğŸ” é‡è¦ãªç™ºè¦‹

**kubectl ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆçµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã ãŒã€Pod è‡ªä½“ã¯å¤–éƒ¨ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ï¼**

ã“ã‚Œã¯ Kubernetes ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¢ãƒ‡ãƒ«ã®æ ¸å¿ƒã§ã™ï¼š

- âœ… **kubectl â†’ AKS API Server**: ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆçµŒç”±ï¼‰
- âŒ **å¤–éƒ¨ â†’ Pod ç›´æ¥**: ä¸å¯èƒ½ï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ï¼‰
- âœ… **Ingress â†’ Pod**: è¨±å¯ã•ã‚ŒãŸçµŒè·¯ã®ã¿ï¼ˆHTTP/HTTPSï¼‰

---

## ğŸ“Š å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ã‚ãªãŸã®PC (Windows)                            â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  kubectl ã‚³ãƒãƒ³ãƒ‰                                        â”‚    â”‚
â”‚  â”‚  (PowerShell / CMD)                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                            â”‚                                      â”‚
â”‚                            â”‚ 1. èªè¨¼æƒ…å ±èª­ã¿è¾¼ã¿                  â”‚
â”‚                            â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ~/.kube/config                                          â”‚    â”‚
â”‚  â”‚  - Cluster: aks-dev                                      â”‚    â”‚
â”‚  â”‚  - Server: https://aks-dev-ax196xm1.hcp.japaneast...    â”‚    â”‚
â”‚  â”‚  - User: clusterUser_rg-bbs-cicd-aks_aks-dev            â”‚    â”‚
â”‚  â”‚  - Certificate: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸                        â”‚    â”‚
â”‚  â”‚  - Token: Azure AD Token                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ 2. HTTPSé€šä¿¡ (Port 443)
                            â”‚    TLSæš—å·åŒ–
                            â”‚    ğŸŒ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆçµŒç”±
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Internet                                        â”‚
â”‚                   (ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ 3. Azureå¢ƒç•Œé€šé
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Azure Japan East Region                              â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸ¯ AKS API Server (Control Plane)                      â”‚    â”‚
â”‚  â”‚  URL: https://aks-dev-ax196xm1.hcp.japaneast.azmk8s.io â”‚    â”‚
â”‚  â”‚  Port: 443 (HTTPS)                                       â”‚    â”‚
â”‚  â”‚  ğŸŒ ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ                             â”‚    â”‚
â”‚  â”‚                                                           â”‚    â”‚
â”‚  â”‚  æ©Ÿèƒ½:                                                    â”‚    â”‚
â”‚  â”‚  - èªè¨¼ãƒ»èªå¯ (Azure AD + Kubernetes RBAC)               â”‚    â”‚
â”‚  â”‚  - API ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†                                     â”‚    â”‚
â”‚  â”‚  - etcd ã¸ã®æ°¸ç¶šåŒ–                                        â”‚    â”‚
â”‚  â”‚  - Worker Node ã¸ã®æŒ‡ç¤º                                  â”‚    â”‚
â”‚  â”‚                                                           â”‚    â”‚
â”‚  â”‚  âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£:                                        â”‚    â”‚
â”‚  â”‚  - Azure ADèªè¨¼å¿…é ˆ                                      â”‚    â”‚
â”‚  â”‚  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸æ¤œè¨¼                                 â”‚    â”‚
â”‚  â”‚  - IPåˆ¶é™å¯èƒ½ï¼ˆç¾åœ¨ã¯ç„¡åˆ¶é™ï¼‰                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                            â”‚                                      â”‚
â”‚                            â”‚ 4. å†…éƒ¨é€šä¿¡ (ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯)â”‚
â”‚                            â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸ”’ VNet: vnetdev (10.0.0.0/16)                         â”‚    â”‚
â”‚  â”‚     ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ - å¤–éƒ¨ã‹ã‚‰ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯   â”‚    â”‚
â”‚  â”‚                                                           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ Subnet: aks-subnet (10.0.1.0/24)                 â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ Worker Node 1                           â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ (aks-nodepool1-96593604-vmss000000)     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                          â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ kubelet (Node Agent)             â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ - API Serverã‹ã‚‰æŒ‡ç¤ºå—ä¿¡         â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ - Podç®¡ç†                        â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ ğŸ”’ Pod: guestbook-app-xxx       â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Private IP: 10.0.1.55           â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                   â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  /app/wizexercise.txt            â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                   â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  âŒ å¤–éƒ¨ã‹ã‚‰ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯      â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ Worker Node 2                           â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ (aks-nodepool1-96593604-vmss000001)     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                          â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ ğŸ”’ Pod: guestbook-app-xxx       â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Private IP: 10.0.1.25           â”‚  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ ğŸŒ NGINX Ingress Controller (Public Access)      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ External IP: 4.190.29.229                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ Azure Load BalancerçµŒç”±                           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  âœ… è¨±å¯ã•ã‚ŒãŸçµŒè·¯ã§Podã«ã‚¢ã‚¯ã‚»ã‚¹                 â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” èªè¨¼ãƒ•ãƒ­ãƒ¼è©³ç´°

### kubectl exec ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã®æµã‚Œ

```bash
kubectl exec -it guestbook-app-xxx -- cat /app/wizexercise.txt
```

#### ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—

```
1. kubectl ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ (ã‚ãªãŸã®PC)
   â””â”€> kubectl exec -it guestbook-app-xxx -- cat /app/wizexercise.txt

2. ~/.kube/config èª­ã¿è¾¼ã¿
   â”œâ”€> Cluster: aks-dev
   â”œâ”€> Server: https://aks-dev-ax196xm1.hcp.japaneast.azmk8s.io:443
   â”œâ”€> User: clusterUser_rg-bbs-cicd-aks_aks-dev
   â””â”€> Credentials:
       â”œâ”€> Client Certificate (X.509)
       â””â”€> Azure AD Token

3. HTTPS ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡
   â””â”€> TLS 1.2/1.3 æš—å·åŒ–é€šä¿¡
       â””â”€> ğŸŒ Internet çµŒç”±ã§ Azure ã¸
           â””â”€> Port 443 (HTTPS)

4. AKS API Server ã§èªè¨¼ãƒ»èªå¯
   â”œâ”€> âœ… ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸æ¤œè¨¼
   â”œâ”€> âœ… Azure AD ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
   â””â”€> âœ… Kubernetes RBAC ãƒã‚§ãƒƒã‚¯
       â””â”€> ClusterRoleBinding: developer-cluster-admin
           â””â”€> Role: cluster-admin (ã™ã¹ã¦ã®æ¨©é™)
               âš ï¸ è„†å¼±æ€§: éå‰°ãªæ¨©é™ä»˜ä¸

5. API Server â†’ kubelet é€šä¿¡ (å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯)
   â””â”€> ğŸ”’ VNetå†…éƒ¨é€šä¿¡ (10.0.1.0/24)
       â””â”€> Worker Node ã® kubelet ã«ã‚³ãƒãƒ³ãƒ‰è»¢é€

6. kubelet â†’ Pod å®Ÿè¡Œ
   â””â”€> Podå†…ã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
       â””â”€> cat /app/wizexercise.txt

7. ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´
   â””â”€> kubelet â†’ API Server â†’ kubectl
       â””â”€> ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ãŒç”»é¢ã«è¡¨ç¤º
```

---

## ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã®è©³ç´°

### é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼               | ãƒ—ãƒ­ãƒˆã‚³ãƒ« | ãƒãƒ¼ãƒˆ | æš—å·åŒ–       | è©³ç´°                |
| ---------------------- | ---------- | ------ | ------------ | ------------------- |
| **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤** | HTTPS      | 443    | TLS 1.2/1.3  | Kubernetes REST API |
| **ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤**   | TCP        | 443    | -            | ä¿¡é ¼æ€§ã®ã‚ã‚‹é€šä¿¡    |
| **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤**     | IP         | -      | -            | ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°        |
| **èªè¨¼å±¤**             | mTLS       | -      | X.509 è¨¼æ˜æ›¸ | åŒæ–¹å‘èªè¨¼          |

### æš—å·åŒ–ã®è©³ç´°

```
TLS Handshake:
1. Client Hello (kubectl)
   â””â”€> å¯¾å¿œæš—å·ã‚¹ã‚¤ãƒ¼ãƒˆæç¤º

2. Server Hello (API Server)
   â””â”€> æš—å·ã‚¹ã‚¤ãƒ¼ãƒˆé¸æŠ
   â””â”€> ã‚µãƒ¼ãƒãƒ¼è¨¼æ˜æ›¸é€ä¿¡

3. Client Certificate (kubectl)
   â””â”€> ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸é€ä¿¡

4. Finished
   â””â”€> æš—å·åŒ–é€šä¿¡é–‹å§‹
```

---

## ğŸ”‘ èªè¨¼æƒ…å ±ã®ç®¡ç†

### kubectl è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

**å ´æ‰€**: `C:\Users\<username>\.kube\config`

```yaml
apiVersion: v1
clusters:
  - cluster:
      certificate-authority-data: DATA+OMITTED
      server: https://aks-dev-ax196xm1.hcp.japaneast.azmk8s.io:443
    name: aks-dev
contexts:
  - context:
      cluster: aks-dev
      user: clusterUser_rg-bbs-cicd-aks_aks-dev
    name: aks-dev
current-context: aks-dev
kind: Config
preferences: {}
users:
  - name: clusterUser_rg-bbs-cicd-aks_aks-dev
    user:
      client-certificate-data: DATA+OMITTED
      client-key-data: DATA+OMITTED
      token: REDACTED
```

### èªè¨¼è¦ç´ 

| è¦ç´                    | èª¬æ˜                                           | ç”¨é€”                        |
| ---------------------- | ---------------------------------------------- | --------------------------- |
| **Server URL**         | `aks-dev-ax196xm1.hcp.japaneast.azmk8s.io:443` | API Server ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ |
| **Client Certificate** | X.509 è¨¼æ˜æ›¸                                   | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼            |
| **Client Key**         | ç§˜å¯†éµ                                         | è¨¼æ˜æ›¸ã®ç½²åæ¤œè¨¼            |
| **Azure AD Token**     | JWT å½¢å¼                                       | Azure AD èªè¨¼               |
| **CA Certificate**     | èªè¨¼å±€è¨¼æ˜æ›¸                                   | ã‚µãƒ¼ãƒãƒ¼è¨¼æ˜æ›¸æ¤œè¨¼          |

---

## ğŸ¯ API Server ã®è©³ç´°

### URL æ§‹é€ 

```
https://aks-dev-ax196xm1.hcp.japaneast.azmk8s.io:443
        â”‚       â”‚       â”‚    â”‚          â”‚           â”‚
        â”‚       â”‚       â”‚    â”‚          â”‚           â””â”€ ãƒãƒ¼ãƒˆ (HTTPS)
        â”‚       â”‚       â”‚    â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Azure Kubernetesãƒ‰ãƒ¡ã‚¤ãƒ³
        â”‚       â”‚       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ (Japan East)
        â”‚       â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Hosted Control Plane
        â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä¸€æ„è­˜åˆ¥å­ (ãƒ©ãƒ³ãƒ€ãƒ ãƒãƒƒã‚·ãƒ¥)
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¯ãƒ©ã‚¹ã‚¿å
```

### ç‰¹å¾´

| é …ç›®             | è©³ç´°                     |
| ---------------- | ------------------------ |
| **ç®¡ç†ä¸»ä½“**     | Azure (ãƒãƒãƒ¼ã‚¸ãƒ‰)       |
| **ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•** | ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ |
| **å¯ç”¨æ€§**       | 99.95% SLA               |
| **ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°** | Azure è‡ªå‹•ç®¡ç†           |
| **ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ** | Azure è‡ªå‹•é©ç”¨           |
| **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—** | etcd è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—    |

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½

- âœ… **Azure AD çµ±åˆ**: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºèªè¨¼
- âœ… **RBAC**: ãã‚ç´°ã‹ã„ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- âœ… **Network Policy**: Pod é–“é€šä¿¡åˆ¶å¾¡
- âœ… **Private Cluster**: API Server ã‚’ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆåŒ–å¯èƒ½ï¼ˆç¾åœ¨ã¯ç„¡åŠ¹ï¼‰
- âœ… **IP åˆ¶é™**: ç‰¹å®š IP ã‹ã‚‰ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯å¯èƒ½ï¼ˆç¾åœ¨ã¯ç„¡åˆ¶é™ï¼‰
- âœ… **ç›£æŸ»ãƒ­ã‚°**: ã™ã¹ã¦ã® API å‘¼ã³å‡ºã—ã‚’è¨˜éŒ²

---

## ğŸš¦ ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®æ¯”è¼ƒ

### kubectl vs Web ãƒ–ãƒ©ã‚¦ã‚¶

| ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•      | çµŒè·¯                                          | èªè¨¼              | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ          | ã‚¢ã‚¯ã‚»ã‚¹å¯å¦ |
| ----------------- | --------------------------------------------- | ----------------- | ------------------- | ------------ |
| **kubectl exec**  | Internet â†’ API Server â†’ kubelet â†’ Pod         | Azure AD + è¨¼æ˜æ›¸ | Pod å†…éƒ¨            | âœ… å¯èƒ½      |
| **Web Browser**   | Internet â†’ Azure LB â†’ Ingress â†’ Service â†’ Pod | ãªã—              | HTTP/HTTPS endpoint | âœ… å¯èƒ½      |
| **ç›´æ¥ Pod IP**   | Internet â†’ ???                                | ???               | Pod (10.0.1.x)      | âŒ ä¸å¯èƒ½    |
| **ç›´æ¥ Node SSH** | Internet â†’ ???                                | ???               | Worker Node         | âŒ ä¸å¯èƒ½    |

### ãªãœ kubectl ã¯å¤–éƒ¨ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã®ã‹ï¼Ÿ

**ç­”ãˆ: API Server ãŒãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã ã‹ã‚‰**

```
kubectl â†’ ğŸŒ Internet â†’ ğŸ¯ API Server (Public) â†’ ğŸ”’ kubelet (Private) â†’ ğŸ”’ Pod (Private)
           â†‘                    â†‘                       â†‘                    â†‘
         å¤–éƒ¨ã‹ã‚‰             Azureç®¡ç†ã®             VNetå†…éƒ¨ã®ã¿          VNetå†…éƒ¨ã®ã¿
         ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½         ãƒ‘ãƒ–ãƒªãƒƒã‚¯IP            ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½          ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
```

**é‡è¦:**

- API Server ã¯**æ„å›³çš„ã«ãƒ‘ãƒ–ãƒªãƒƒã‚¯**ã«ã•ã‚Œã¦ã„ã‚‹
- ã“ã‚Œã«ã‚ˆã‚Šã€ã©ã“ã‹ã‚‰ã§ã‚‚ã‚¯ãƒ©ã‚¹ã‚¿ç®¡ç†ãŒå¯èƒ½
- ãŸã ã—ã€**å¼·å›ºãªèªè¨¼ãƒ»èªå¯**ã§ä¿è­·ã•ã‚Œã¦ã„ã‚‹

### ãªãœ Pod ã«ã¯ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã®ã‹ï¼Ÿ

**ç­”ãˆ: Pod ã¯ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ IP ã—ã‹æŒãŸãªã„ã‹ã‚‰**

```
å¤–éƒ¨ â†’ âŒ Pod (10.0.1.55) â†’ åˆ°é”ä¸å¯
       â””â”€ VNetå†…éƒ¨ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIP
          â””â”€ Internet routingä¸å¯

å¤–éƒ¨ â†’ âœ… Ingress (4.190.29.229) â†’ Pod
       â””â”€ Azure Load Balancerã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯IP
          â””â”€ è¨±å¯ã•ã‚ŒãŸçµŒè·¯ã§Podã«ã‚¢ã‚¯ã‚»ã‚¹
```

---

## ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®è€ƒæ…®ç‚¹

### ãƒ‘ãƒ–ãƒªãƒƒã‚¯ API Server ã®ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯                   | èª¬æ˜                | å¯¾ç­–                                |
| ------------------------ | ------------------- | ----------------------------------- |
| **ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒ** | èªè¨¼æƒ…å ±ã®ç·å½“ãŸã‚Š  | âœ… Azure AD MFA å¼·åˆ¶                |
| **èªè¨¼æƒ…å ±æ¼æ´©**         | ~/.kube/config æµå‡º | âœ… å®šæœŸçš„ãªè¨¼æ˜æ›¸ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³     |
| **DDoS æ”»æ’ƒ**            | API Server éè² è·   | âœ… Azure DDoS Protection            |
| **ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹**         | æœªæ‰¿èªãƒ¦ãƒ¼ã‚¶ãƒ¼      | âœ… RBAC + Azure AD æ¡ä»¶ä»˜ãã‚¢ã‚¯ã‚»ã‚¹ |
| **å†…éƒ¨è„…å¨**             | éå‰°ãªæ¨©é™          | âš ï¸ cluster-admin æ¨©é™ï¼ˆè„†å¼±æ€§ï¼‰     |

### æœ¬ç•ªç’°å¢ƒã§ã®æ¨å¥¨è¨­å®š

```bash
# 1. Private Clusteræœ‰åŠ¹åŒ–
az aks create --enable-private-cluster

# 2. API Server IPåˆ¶é™
az aks update \
  --api-server-authorized-ip-ranges "203.0.113.0/24,198.51.100.0/24"

# 3. Azure ADçµ±åˆå¼·åŒ–
az aks update --enable-azure-rbac

# 4. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒãƒªã‚·ãƒ¼æœ‰åŠ¹åŒ–
az aks create --network-policy azure
```

---

## ğŸ“Š kubectl vs Ingress æ¯”è¼ƒè¡¨

| é …ç›®             | kubectl                                    | Ingress (Web)                                                 |
| ---------------- | ------------------------------------------ | ------------------------------------------------------------- |
| **çµŒè·¯**         | PC â†’ Internet â†’ API Server â†’ kubelet â†’ Pod | PC â†’ Internet â†’ Azure LB â†’ Ingress Controller â†’ Service â†’ Pod |
| **èªè¨¼**         | Azure AD + ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸              | ãªã—ï¼ˆãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ï¼‰                                    |
| **ãƒ—ãƒ­ãƒˆã‚³ãƒ«**   | HTTPS (Port 443)                           | HTTP/HTTPS (Port 80/443)                                      |
| **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ**   | Kubernetes API                             | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ                                |
| **ã‚¢ã‚¯ã‚»ã‚¹ç¯„å›²** | ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ï¼ˆRBAC æ¬¡ç¬¬ï¼‰              | å…¬é–‹ã•ã‚ŒãŸ HTTP/HTTPS ã®ã¿                                    |
| **ç”¨é€”**         | ç®¡ç†ãƒ»é‹ç”¨ãƒ»ãƒ‡ãƒãƒƒã‚°                       | ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¯ã‚»ã‚¹                                        |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£** | å¼·å›ºï¼ˆå¤šè¦ç´ èªè¨¼ï¼‰                         | å¼±ã„ï¼ˆèªè¨¼ãªã—ï¼‰ âš ï¸                                           |
| **å¤–éƒ¨å…¬é–‹**     | API Server ã®ã¿å…¬é–‹                        | Ingress Controller ã‚’å…¬é–‹                                     |

---

## ğŸ” æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰

### API Server æƒ…å ±ã®ç¢ºèª

```bash
# ã‚¯ãƒ©ã‚¹ã‚¿æƒ…å ±
kubectl cluster-info

# å‡ºåŠ›ä¾‹:
# Kubernetes control plane is running at https://aks-dev-ax196xm1.hcp.japaneast.azmk8s.io:443

# ç¾åœ¨ã®è¨­å®šè¡¨ç¤º
kubectl config view --minify

# æ¥ç¶šãƒ†ã‚¹ãƒˆ
kubectl get nodes
```

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¢ºèª

```bash
# API Serverã¸ã®æ¥ç¶šç¢ºèª
curl -k https://aks-dev-ax196xm1.hcp.japaneast.azmk8s.io:443

# Pod IPç¢ºèªï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPï¼‰
kubectl get pods -o wide

# Ingress IPç¢ºèªï¼ˆãƒ‘ãƒ–ãƒªãƒƒã‚¯IPï¼‰
kubectl get svc -n ingress-nginx ingress-nginx-controller
```

---

## ğŸ’¡ ã¾ã¨ã‚

### é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

1. **kubectl ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹**

   - API Server ãŒãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ Internet å…¬é–‹
   - Azure AD + è¨¼æ˜æ›¸ã«ã‚ˆã‚‹å¼·å›ºãªèªè¨¼

2. **Pod ã¯ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ**

   - VNet å†…éƒ¨ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ IP ã®ã¿
   - ç›´æ¥å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯

3. **2 ã¤ã®ã‚¢ã‚¯ã‚»ã‚¹çµŒè·¯**

   - ç®¡ç†ç”¨: kubectl â†’ API Server â†’ Pod
   - ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”¨: Browser â†’ Ingress â†’ Service â†’ Pod

4. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å¤šå±¤é˜²å¾¡**
   - API Server: èªè¨¼ãƒ»èªå¯ãƒ»ç›£æŸ»
   - Network: VNet åˆ†é›¢ã€NSGã€Network Policy
   - RBAC: ãã‚ç´°ã‹ã„æ¨©é™åˆ¶å¾¡

### ãƒ‡ãƒ¢ç’°å¢ƒã§ã®è„†å¼±æ€§

âš ï¸ **æ„å›³çš„ã«è¨­å®šã—ãŸè„†å¼±æ€§**:

- API Server ãŒ IP åˆ¶é™ãªã—ã§ãƒ‘ãƒ–ãƒªãƒƒã‚¯å…¬é–‹
- cluster-admin æ¨©é™ã®éå‰°ä»˜ä¸
- Ingress ãŒèªè¨¼ãªã—ã§ãƒ‘ãƒ–ãƒªãƒƒã‚¯å…¬é–‹

æœ¬ç•ªç’°å¢ƒã§ã¯**å¿…ãšå¯¾ç­–ã™ã‚‹ã“ã¨**ï¼

---

## ğŸ“š å‚è€ƒè³‡æ–™

- [Azure Kubernetes Service (AKS) documentation](https://learn.microsoft.com/azure/aks/)
- [Kubernetes API Server](https://kubernetes.io/docs/concepts/overview/kubernetes-api/)
- [Azure AD integration for AKS](https://learn.microsoft.com/azure/aks/azure-ad-integration-cli)
- [Private AKS clusters](https://learn.microsoft.com/azure/aks/private-clusters)
