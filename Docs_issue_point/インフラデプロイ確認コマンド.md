# ã‚¤ãƒ³ãƒ•ãƒ©ãƒ‡ãƒ—ãƒ­ã‚¤ç¢ºèªã‚³ãƒãƒ³ãƒ‰ - ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

**ä½œæˆæ—¥**: 2025 å¹´ 1 æœˆ 29 æ—¥  
**ç”¨é€”**: Azure ãƒªã‚½ãƒ¼ã‚¹ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ç¢ºèªãƒ»æ¤œè¨¼ãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

---

## ğŸ“‹ æ¦‚è¦

Azure ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸå¾Œã«ã€ãƒªã‚½ãƒ¼ã‚¹ã®çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã® Azure CLI ã‚³ãƒãƒ³ãƒ‰é›†ã§ã™ã€‚

---

## ğŸ” ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã®ç¢ºèªæ‰‹é †

### 1. ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ç¢ºèª

```powershell
# ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’è¡¨ç¤º
az resource list -g rg-cicd-aks-bbs -o table

# ãƒªã‚½ãƒ¼ã‚¹æ•°ã‚’ç¢ºèª
az resource list -g rg-cicd-aks-bbs --query "length([])"
```

### 2. AKS ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®ç¢ºèª

```powershell
# AKS ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®çŠ¶æ…‹ã‚’ç¢ºèª
az aks show -g rg-cicd-aks-bbs -n aks-wiz-exercise --query "{Name:name, Status:powerState.code, KubernetesVersion:kubernetesVersion, NodeCount:agentPoolProfiles[0].count}" -o table

# AKS èªè¨¼æƒ…å ±ã‚’å–å¾—
az aks get-credentials -g rg-cicd-aks-bbs -n aks-wiz-exercise --overwrite-existing

# ãƒãƒ¼ãƒ‰ã‚’ç¢ºèª
kubectl get nodes
```

### 3. MongoDB VM ã®ç¢ºèª

```powershell
# VM ã®çŠ¶æ…‹ã‚’ç¢ºèª
az vm show -g rg-cicd-aks-bbs -n vm-mongo-dev --query "{Name:name, ProvisioningState:provisioningState, PowerState:instanceView.statuses[1].displayStatus}" -o table

# VM ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—
az vm list-ip-addresses -g rg-cicd-aks-bbs -n vm-mongo-dev --query "[0].virtualMachine.network.publicIpAddresses[0].ipAddress" -o tsv
```

### 4. Azure Container Registry ã®ç¢ºèª

```powershell
# ACR ã®çŠ¶æ…‹ã‚’ç¢ºèª
az acr show -n acrwizexercise --query "{Name:name, LoginServer:loginServer, Sku:sku.name}" -o table

# AKS ã¨ ACR ã‚’çµ±åˆ
az aks update -g rg-cicd-aks-bbs -n aks-wiz-exercise --attach-acr acrwizexercise
```

### 5. Log Analytics ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ç¢ºèª

```powershell
# Log Analytics ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’ç¢ºèª
az monitor log-analytics workspace show -g rg-cicd-aks-bbs -n log-wiz-exercise --query "{Name:name, Location:location}" -o table
```

### 6. Virtual Network ã®ç¢ºèª

```powershell
# VNet ã¨ã‚µãƒ–ãƒãƒƒãƒˆã‚’ç¢ºèª
az network vnet show -g rg-cicd-aks-bbs -n vnet-wiz-exercise --query "{Name:name, AddressSpace:addressSpace.addressPrefixes[0]}" -o table

az network vnet subnet list -g rg-cicd-aks-bbs --vnet-name vnet-wiz-exercise -o table
```

### 7. Storage Account ã®ç¢ºèª

```powershell
# Storage Account ã‚’ç¢ºèª
az storage account show -n stwizexercise -g rg-cicd-aks-bbs --query "{Name:name, Location:location, Sku:sku.name}" -o table

# Blob ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ã‚’ç¢ºèª
az storage container list --account-name stwizexercise -o table
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¤±æ•—ã—ãŸå ´åˆ

#### 1. ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª

GitHub Actions ã®ãƒ­ã‚°ã§è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã—ã¾ã™ã€‚

#### 2. Azure Provider ã®ç™»éŒ²ç¢ºèª

```powershell
# å¿…è¦ãª Provider ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
az provider show --namespace Microsoft.ContainerService --query "registrationState"
az provider show --namespace Microsoft.Compute --query "registrationState"
az provider show --namespace Microsoft.Network --query "registrationState"
az provider show --namespace Microsoft.Storage --query "registrationState"
az provider show --namespace Microsoft.ContainerRegistry --query "registrationState"

# æœªç™»éŒ²ã®å ´åˆã¯ç™»éŒ²
az provider register --namespace Microsoft.ContainerService --wait
az provider register --namespace Microsoft.Compute --wait
az provider register --namespace Microsoft.Network --wait
az provider register --namespace Microsoft.Storage --wait
az provider register --namespace Microsoft.ContainerRegistry --wait
```

#### 3. ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã®ç¢ºèª

```powershell
# ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
az group show -n rg-cicd-aks-bbs

# å­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
az group create -n rg-cicd-aks-bbs -l japaneast
```

#### 4. ã‚¯ã‚©ãƒ¼ã‚¿ã®ç¢ºèª

```powershell
# VM ã®ã‚¯ã‚©ãƒ¼ã‚¿ã‚’ç¢ºèª
az vm list-usage -l japaneast --query "[?name.value=='standardDSv2Family'].{Name:name.localizedValue, Current:currentValue, Limit:limit}" -o table

# AKS ã®ã‚¯ã‚©ãƒ¼ã‚¿ã‚’ç¢ºèª
az vm list-usage -l japaneast --query "[?contains(name.value, 'Cores')].{Name:name.localizedValue, Current:currentValue, Limit:limit}" -o table
```

#### 5. æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã®ç«¶åˆç¢ºèª

```powershell
# åŒåã®ãƒªã‚½ãƒ¼ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
az aks show -n aks-wiz-exercise -g rg-cicd-aks-bbs 2>&1
az vm show -n vm-mongo-dev -g rg-cicd-aks-bbs 2>&1
az acr show -n acrwizexercise 2>&1
```

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸå¾Œã®æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### 1. AKS ã¨ ACR ã‚’çµ±åˆ

```powershell
# ACR ã‹ã‚‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ—ãƒ«ã§ãã‚‹ã‚ˆã†ã« AKS ã«æ¨©é™ã‚’ä»˜ä¸
az aks update -g rg-cicd-aks-bbs -n aks-wiz-exercise --attach-acr acrwizexercise
```

### 2. MongoDB ã¸ã®æ¥ç¶šç¢ºèª

```powershell
# VM ã® IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—
$MONGO_IP = az vm list-ip-addresses -g rg-cicd-aks-bbs -n vm-mongo-dev --query "[0].virtualMachine.network.publicIpAddresses[0].ipAddress" -o tsv

# SSH ã§æ¥ç¶šãƒ†ã‚¹ãƒˆ (ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ MONGO_ADMIN_PASSWORD ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ)
ssh azureuser@$MONGO_IP

# MongoDB ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª (VM å†…ã§å®Ÿè¡Œ)
sudo systemctl status mongod
```

### 3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤ã®æº–å‚™

ã‚¤ãƒ³ãƒ•ãƒ©ãŒæ­£å¸¸ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸã‚‰ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã¿ã¾ã™:

1. **ã‚¢ãƒ—ãƒªãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡Œ**

   - GitHub Actions ã§ã€ŒBuild and Deploy Applicationã€ã‚’æ‰‹å‹•å®Ÿè¡Œ
   - ã¾ãŸã¯ `app/` é…ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã—ã¦ã‚³ãƒŸãƒƒãƒˆ

2. **ãƒ‡ãƒ—ãƒ­ã‚¤å†…å®¹**
   - Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã¨ ACR ã¸ã®ãƒ—ãƒƒã‚·ãƒ¥
   - Kubernetes ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®é©ç”¨
   - Ingress ã®è¨­å®š

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

### Azure ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [AKS ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ](https://learn.microsoft.com/ja-jp/azure/aks/learn/quick-kubernetes-deploy-cli)
- [Azure Container Registry](https://learn.microsoft.com/ja-jp/azure/container-registry/)
- [Bicep ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://learn.microsoft.com/ja-jp/azure/azure-resource-manager/bicep/)

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‚è€ƒ

- [AKS ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](https://learn.microsoft.com/ja-jp/azure/aks/troubleshooting)
- [Azure CLI ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://learn.microsoft.com/ja-jp/cli/azure/)
- [Azure CLI ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](https://learn.microsoft.com/ja-jp/cli/azure/use-cli-effectively)

---

**ä½œæˆè€…**: aktsmm  
**æœ€çµ‚æ›´æ–°**: 2025 å¹´ 1 æœˆ 29 æ—¥

**é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**:

- `Docs_issue_point/README.md` - ãƒˆãƒ©ãƒ–ãƒ«è¨˜éŒ²ç®¡ç†ã‚¬ã‚¤ãƒ‰
- `Docs_work_history/Phase01_ç’°å¢ƒæº–å‚™_2025-01-29.md` - ä½œæ¥­å±¥æ­´

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: CICD-AKS-Technical Exercise
